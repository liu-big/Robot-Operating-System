# `scripts` 文件夹使用开发操作手册

## 1. 概述

在 `send_goals` ROS 包中，`scripts` 文件夹用于存放可执行的 Python 脚本。这些脚本通常用于实现一些辅助功能、测试、数据发布或特定任务，它们可能不适合作为编译后的 C++ 节点，或者更适合用 Python 快速开发和迭代。此文件夹中的脚本为 `send_goals` 包提供了灵活性和快速开发的能力，例如处理相机 TF 变换、发布位置信息等。

## 2. 文件夹结构

```
src/send_goals/scripts/
├── camera_tf.py
├── camera_tf_2.py
├── pub_pos.py
└── test.py
```

- `camera_tf.py`: 可能用于发布相机坐标系与机器人其他坐标系之间的 TF 变换，确保图像数据能够正确地在机器人坐标系中定位。
- `camera_tf_2.py`: 可能是 `camera_tf.py` 的另一个版本或改进版，用于处理相机 TF 变换。
- `pub_pos.py`: 可能用于发布机器人的位置信息，例如通过订阅里程计数据并将其发布到自定义话题，或用于测试目的。
- `test.py`: 通用测试脚本，可能用于验证包的某个功能或进行简单的功能测试。

## 3. 主要功能与用途

`scripts` 文件夹的主要功能是：

- **TF 变换发布**：动态发布相机或其他传感器在机器人坐标系中的位置和姿态变换，确保 ROS 系统中所有传感器数据都处于正确的坐标系下。
- **数据发布**：发布自定义的 ROS 话题数据，例如机器人当前位置、状态信息等，用于调试、监控或与其他模块交互。
- **功能测试**：提供快速验证包内功能或外部接口的测试脚本。
- **辅助工具**：实现一些不适合作为常驻节点运行的辅助性任务。

## 4. 使用方法

- **执行脚本**：
  在 ROS 环境中，确保脚本具有执行权限（`chmod +x script_name.py`），然后可以使用 `rosrun` 命令运行脚本：
  ```bash
  rosrun send_goals camera_tf.py
  ```
  或者直接通过 Python 解释器运行（如果脚本顶部有 `#!/usr/bin/env python` 或 `#!/usr/bin/env python3`）：
  ```bash
  python3 src/send_goals/scripts/pub_pos.py
  ```
- **在 Launch 文件中调用**：
  这些脚本也可以在 `.launch` 文件中作为节点启动：
  ```xml
  <node pkg="send_goals" type="camera_tf.py" name="camera_tf_publisher" />
  ```
- **修改脚本**：
  直接编辑 `.py` 文件来修改脚本的逻辑。修改后，无需重新编译，可以直接运行。

## 5. 项目全局应用

在 `ucar_ws` 项目中，`send_goals` 包的 `scripts` 文件夹提供了快速原型开发和灵活的功能扩展能力。Python 脚本的易用性使得开发者能够迅速实现和测试新的想法，尤其是在处理 TF 变换和数据发布等需要频繁调整的场景。它们是 `send_goals` 包功能的重要补充，使得整个系统更加完善和易于调试。

## 6. 维护与更新

- **代码规范**：遵循 Python 编码规范（如 PEP 8），确保代码的可读性和可维护性。
- **错误处理**：在脚本中添加适当的错误处理和日志记录，以便于调试。
- **依赖管理**：确保脚本所依赖的 Python 库和 ROS 包已正确安装。
- **版本控制**：将脚本纳入版本控制，并记录每次更新的详细信息。

## 7. 故障排除

- **脚本无法执行**：
  - 检查脚本是否具有执行权限（`ls -l script_name.py`，如果没有 `x` 权限，使用 `chmod +x script_name.py`）。
  - 检查脚本顶部的 shebang（`#!/usr/bin/env python` 或 `#!/usr/bin/env python3`）是否正确，并且对应的 Python 解释器已安装。
  - 检查 `rosrun` 命令中的包名和脚本名是否正确。
- **脚本运行报错**：
  - 查看终端输出的 Python 错误信息，根据错误栈追踪问题。
  - 检查脚本中引用的 ROS 话题、参数或服务是否存在。
  - 确保所有必要的 ROS 节点（如 `roscore`）正在运行。
- **TF 变换不正确**：
  - 使用 `rqt_tf_tree` 查看 TF 树，确认 `camera_tf.py` 或 `camera_tf_2.py` 是否发布了正确的 TF 变换。
  - 检查脚本中定义的父子坐标系名称是否正确。
  - 检查变换的平移和旋转参数是否准确。